{% extends 'layout.html' %}
{% load static %}

{% block title %}
Lista de Livros
{% endblock %}

{% block content %}


<div class="genre-container" style="text-align:center; margin-bottom:25px; background-color:#800020">
    <button id="toggleBtn" style="background-color:#800020; color:white; border:none; padding:10px 16px; cursor:pointer; width: 100%;">
        Gêneros
    </button>

    <div id="genresDiv" style="display:none; margin-top:15px; flex-wrap:wrap; gap:8px; background-color:#800020;">
        <button class="filter-btn active" data-genero="todos" style="border:none; padding:5px 10px; border-radius:5px; cursor:pointer; margin:3px;">
          Nenhum
        </button>

        {% for genero in todos_generos %}
        <button class="filter-btn" data-genero="{{ genero.slug }}" style="border:none; padding:5px 10px; border-radius:5px; cursor:pointer; margin:3px;">
          {{ genero.name }}
        </button>
        {% endfor %}

    </div>
</div>

<h2 style="color:#800020; text-align:center; margin-bottom: 20px;">Mostrando Todos os Livros</h2>

<div id="bookContainer" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:20px; padding:20px;">
    {% for book in books %}
    <article class="book"
             data-generos="{% for g in book.generos.all %}{{ g.slug }}{% if not forloop.last %},{% endif %}{% endfor %}"
             style="border:1px solid #ddd; border-radius:8px; padding:15px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1); text-align:center;">
        
        {% if book.cover %}
        <img src="{{ book.cover }}" alt="{{ book.title }}" style="width:120px; height:auto; margin-bottom:10px;">
        {% else %}
        <img src="https://m.media-amazon.com/images/I/81jNZrJBJgL._SL1500_.jpg" alt="Livro genérico" style="width:120px; height:auto; margin-bottom:10px;">
        {% endif %}
        
        <h2 style="color:#800020; font-size:1.2rem; margin-bottom:10px;">
            <a href="{% url 'library:detail' book.slug %}" style="color:#800020; text-decoration:none;">
                {{ book.title }}
            </a>
        </h2>
        
        <strong>Autor:</strong> <span>{{ book.author|default:"Autor Desconhecido" }}</span><br>
        <strong>Gênero:</strong>
        <span>
            {% for g in book.generos.all %}
                {{ g.name }}{% if not forloop.last %}, {% endif %}
            {% empty %}
                Literatura
            {% endfor %}
        </span><br>
        <strong>Ano:</strong> <span>{{ book.year|default:"Desconhecido" }}</span><br>
        <strong>Preço:</strong> <span>{{ book.price|default:"29.90" }}</span><br>
        <small>Adicionado em {{ book.creationdate }}</small><br>

        <a href="{% url 'library:add_to_wishlist' book.id %}"
           style="display:inline-block; margin-top:10px; padding:8px 12px; background:#800020; color:white; text-decoration:none; border-radius:5px;">
            Adicionar à Lista de Desejos
        </a>
    </article>
    {% empty %}
    <p style="text-align:center; color:#555;">Nenhum livro encontrado.</p>
    {% endfor %}
</div>


<script src="{% static 'scripts/booklist.js' %}"></script>
{% endblock %}